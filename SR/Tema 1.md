
## Securitatea Rețelelor: Tema 1

##

#### Student: Ceaușescu Ciprian - Mihai, grupa 406
#### Îndrumător laborator: Roșca Miruna

##

##### Enunțul problemei: Se dă un sistem RSA cu modul public de criptare $n$ ($n=p*q$ cu $p$ si $q$ prime), modul de exponențiere $e=65537$ și modul de decriptare $d$. Știind valoarea $g=d*(p-17)$, factorizați numărul $n$.

##### Hint: Euler Theorem, Fermat's little theorem.

$n$ este
17892995785858018705691683494198766138575572169777370932155077103706225543789153728394914088904268434334118581305072940383037719362701955498269328384843973496991788776148141387151942605209396056835597454162123892465276931677532494978104675820603838570797030973150254167275634007029179776118204360235558371227495512320211661935647844266380197122301756515158377762939692418347394882646858444355660340375932441893282040008725939366773341632059026894602819005170068827290844849873410982728114386423630929514662796908657914306924764818082771241376925572899087750817327146485409660615344859545977984617743567137435276344733

$e$ este 
65537

$g=d*(p-17)$ este
391313992157321845828274183704751011513753189337958033769778667738330236596121558965650175912235805259643309468600020095630004604324489216882189998094441351292823399321211433451605876813689913998676880073287837416625548715631107900888255619356029219074196389511778102967994647051780282998710036616600358005979527937528615903969651210309759572887401728010897006473238066387270425054724521798362147733363355762876507825536592617203634385025375697575672781394511014698442670472806636686989296428399137832282377854591726518061720167920056886737857829256211680287190719065333974601245605454862642760855880786273856713534746761931720922536046319407599147293646508426769986338755985479989779974188368589894049325779335103443881405641591567013063358812879301330167120526015629558089844172509982133486454375580355648293548751808265761065131520241645147934840880946790357183506092347037238136283053666084776156439233294453572726447072

### Inițializarea datelor problemei:


```python
n = 17892995785858018705691683494198766138575572169777370932155077103706225543789153728394914088904268434334118581305072940383037719362701955498269328384843973496991788776148141387151942605209396056835597454162123892465276931677532494978104675820603838570797030973150254167275634007029179776118204360235558371227495512320211661935647844266380197122301756515158377762939692418347394882646858444355660340375932441893282040008725939366773341632059026894602819005170068827290844849873410982728114386423630929514662796908657914306924764818082771241376925572899087750817327146485409660615344859545977984617743567137435276344733

g = 391313992157321845828274183704751011513753189337958033769778667738330236596121558965650175912235805259643309468600020095630004604324489216882189998094441351292823399321211433451605876813689913998676880073287837416625548715631107900888255619356029219074196389511778102967994647051780282998710036616600358005979527937528615903969651210309759572887401728010897006473238066387270425054724521798362147733363355762876507825536592617203634385025375697575672781394511014698442670472806636686989296428399137832282377854591726518061720167920056886737857829256211680287190719065333974601245605454862642760855880786273856713534746761931720922536046319407599147293646508426769986338755985479989779974188368589894049325779335103443881405641591567013063358812879301330167120526015629558089844172509982133486454375580355648293548751808265761065131520241645147934840880946790357183506092347037238136283053666084776156439233294453572726447072

e = 65537
```

### Pentru determinarea numerelor $p$ și $q$ vom efectua următoarele operații:




```python
# Vom ridica la puterea g, numărul 2 și vom calcula restul împărțirii numărului rezultat la n, adică vom determina valoarea numărului 2^g in Zn.

two_g = power_mod(2, g, n)

# Știm faptul că g=d*(p-17), astfel încât putem determina cât este 2^(p-17). Vom ridica numărul two_g la puterea e și datorită faptului că e*d=1, rezultatul este chiar (2^g)^e=2^(p-17). 

two_p_minus_17 = power_mod(two_g, e, n)
```


```python
# Din rezultatul two_p_minus_17 puterm determina 2^(p-1), înmulțind two_p_minus_17 cu 2^16. Vom determina 2^(p-1) în Zn.

two_p_minus_1 = (two_p_minus_17 * (2**16))%n
```


```python
# Din Fermat's little theorem știm că 2^(p-1) este congruent cu 1 mod p. Astfel încât un număr alpha_p este numărul two_p_minus_1 - 1

alpha_p = two_p_minus_1-1
```


```python
# Determinăm cel mai mare divizor comun dintre n și alpha_p, acesta fiind chiar p, pentru ca n=p*q și n=alpha*p.

p = gcd(n, alpha_p)
```


```python
# Afișăm numărul p care a fost determinat

p
```




    147683962099792759281198431285374517264898055533033871983398875472112159062124337441059799584773490916691328184236888883979859116291943909894157915692431140952065882091266375780508622112517564490518901701882043771736338358393159910500923592331995809719475072454110750435324952660936713890430199324199591658481




```python
# Numărul q este n/p

q = n/p
```


```python
# Afișăm numărul q care a fost determinat

q
```




    121157338491280411277702993150216903391199238778918843133769913054320489323599686987336539404832178428962865557576548088790063274550339739265377876571708081033071922510318938124631522315245789856427603225623406152033781181484345299692567352787585818833091773406775268556096035617760060650516195497951603626093




```python
# Verificăm dacă n este p*q

n==p*q
```




    True


